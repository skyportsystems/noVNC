'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

// From: http://hg.mozilla.org/mozilla-central/raw-file/ec10630b1a54/js/src/devtools/jint/sunspider/string-base64.js

/*jslint white: false */
/*global console */

var Base64 = {
    /* Convert data (an array of integers) to a Base64 string. */
    toBase64Table: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.split(''),
    base64Pad: '=',

    encode: function (data) {
        "use strict";

        var result = '';
        var toBase64Table = Base64.toBase64Table;
        var length = data.length;
        var lengthpad = length % 3;
        // Convert every three bytes to 4 ascii characters.

        for (var i = 0; i < length - 2; i += 3) {
            result += toBase64Table[data[i] >> 2];
            result += toBase64Table[((data[i] & 0x03) << 4) + (data[i + 1] >> 4)];
            result += toBase64Table[((data[i + 1] & 0x0f) << 2) + (data[i + 2] >> 6)];
            result += toBase64Table[data[i + 2] & 0x3f];
        }

        // Convert the remaining 1 or 2 bytes, pad out to 4 characters.
        var j = 0;
        if (lengthpad === 2) {
            j = length - lengthpad;
            result += toBase64Table[data[j] >> 2];
            result += toBase64Table[((data[j] & 0x03) << 4) + (data[j + 1] >> 4)];
            result += toBase64Table[(data[j + 1] & 0x0f) << 2];
            result += toBase64Table[64];
        } else if (lengthpad === 1) {
            j = length - lengthpad;
            result += toBase64Table[data[j] >> 2];
            result += toBase64Table[(data[j] & 0x03) << 4];
            result += toBase64Table[64];
            result += toBase64Table[64];
        }

        return result;
    },

    /* Convert Base64 data to a string */
    /* jshint -W013 */
    toBinaryTable: [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, 0, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1],
    /* jshint +W013 */

    decode: function (data, offset) {
        "use strict";

        offset = typeof offset !== 'undefined' ? offset : 0;
        var toBinaryTable = Base64.toBinaryTable;
        var base64Pad = Base64.base64Pad;
        var result, result_length;
        var leftbits = 0; // number of bits decoded, but yet to be appended
        var leftdata = 0; // bits decoded, but yet to be appended
        var data_length = data.indexOf('=') - offset;

        if (data_length < 0) {
            data_length = data.length - offset;
        }

        /* Every four characters is 3 resulting numbers */
        result_length = (data_length >> 2) * 3 + Math.floor(data_length % 4 / 1.5);
        result = new Array(result_length);

        // Convert one by one.
        for (var idx = 0, i = offset; i < data.length; i++) {
            var c = toBinaryTable[data.charCodeAt(i) & 0x7f];
            var padding = data.charAt(i) === base64Pad;
            // Skip illegal characters and whitespace
            if (c === -1) {
                console.error("Illegal character code " + data.charCodeAt(i) + " at position " + i);
                continue;
            }

            // Collect data into leftdata, update bitcount
            leftdata = leftdata << 6 | c;
            leftbits += 6;

            // If we have 8 or more bits, append 8 bits to the result
            if (leftbits >= 8) {
                leftbits -= 8;
                // Append if not padding.
                if (!padding) {
                    result[idx++] = leftdata >> leftbits & 0xff;
                }
                leftdata &= (1 << leftbits) - 1;
            }
        }

        // If there are any bits left, the base64 string was corrupted
        if (leftbits) {
            err = new Error('Corrupted base64 string');
            err.name = 'Base64-Error';
            throw err;
        }

        return result;
    }
}; /* End of Base64 namespace */

exports.default = Base64;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2U2NC5qcyJdLCJuYW1lcyI6WyJCYXNlNjQiLCJ0b0Jhc2U2NFRhYmxlIiwic3BsaXQiLCJiYXNlNjRQYWQiLCJlbmNvZGUiLCJkYXRhIiwicmVzdWx0IiwibGVuZ3RoIiwibGVuZ3RocGFkIiwiaSIsImoiLCJ0b0JpbmFyeVRhYmxlIiwiZGVjb2RlIiwib2Zmc2V0IiwicmVzdWx0X2xlbmd0aCIsImxlZnRiaXRzIiwibGVmdGRhdGEiLCJkYXRhX2xlbmd0aCIsImluZGV4T2YiLCJNYXRoIiwiZmxvb3IiLCJBcnJheSIsImlkeCIsImMiLCJjaGFyQ29kZUF0IiwicGFkZGluZyIsImNoYXJBdCIsImNvbnNvbGUiLCJlcnJvciIsImVyciIsIkVycm9yIiwibmFtZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7OztBQUlBOztBQUVBO0FBQ0E7O0FBRUEsSUFBSUEsU0FBUztBQUNUO0FBQ0FDLG1CQUFnQixvRUFBb0VDLEtBQXBFLENBQTBFLEVBQTFFLENBRlA7QUFHVEMsZUFBZ0IsR0FIUDs7QUFLVEMsWUFBUSxVQUFVQyxJQUFWLEVBQWdCO0FBQ3BCOztBQUNBLFlBQUlDLFNBQVMsRUFBYjtBQUNBLFlBQUlMLGdCQUFnQkQsT0FBT0MsYUFBM0I7QUFDQSxZQUFJTSxTQUFTRixLQUFLRSxNQUFsQjtBQUNBLFlBQUlDLFlBQWFELFNBQVMsQ0FBMUI7QUFDQTs7QUFFQSxhQUFLLElBQUlFLElBQUksQ0FBYixFQUFnQkEsSUFBS0YsU0FBUyxDQUE5QixFQUFrQ0UsS0FBSyxDQUF2QyxFQUEwQztBQUN0Q0gsc0JBQVVMLGNBQWNJLEtBQUtJLENBQUwsS0FBVyxDQUF6QixDQUFWO0FBQ0FILHNCQUFVTCxjQUFjLENBQUMsQ0FBQ0ksS0FBS0ksQ0FBTCxJQUFVLElBQVgsS0FBb0IsQ0FBckIsS0FBMkJKLEtBQUtJLElBQUksQ0FBVCxLQUFlLENBQTFDLENBQWQsQ0FBVjtBQUNBSCxzQkFBVUwsY0FBYyxDQUFDLENBQUNJLEtBQUtJLElBQUksQ0FBVCxJQUFjLElB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QUNWYyxrQkFBTSxJQUFJQyxLQUFKLENBQVUseUJBQVYsQ0FBTjtBQUNBRCxnQkFBSUUsSUFBSixHQUFXLGNBQVg7QUFDQSxrQkFBTUYsR0FBTjtBQUNIOztBQUVELGVBQU92QixNQUFQO0FBQ0g7QUF0R1EsQ0FBYixDLENBdUdHOztrQkFFWU4sTSIsImZpbGUiOiJiYXNlNjQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBUaGlzIFNvdXJjZSBDb2RlIEZvcm0gaXMgc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1vemlsbGEgUHVibGljXG4gKiBMaWNlbnNlLCB2LiAyLjAuIElmIGEgY29weSBvZiB0aGUgTVBMIHdhcyBub3QgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzXG4gKiBmaWxlLCBZb3UgY2FuIG9idGFpbiBvbmUgYXQgaHR0cDovL21vemlsbGEub3JnL01QTC8yLjAvLiAqL1xuXG4vLyBGcm9tOiBodHRwOi8vaGcubW96aWxsYS5vcmcvbW96aWxsYS1jZW50cmFsL3Jhdy1maWxlL2VjMTA2MzBiMWE1NC9qcy9zcmMvZGV2dG9vbHMvamludC9zdW5zcGlkZXIvc3RyaW5nLWJhc2U2NC5qc1xuXG4vKmpzbGludCB3aGl0ZTogZmFsc2UgKi9cbi8qZ2xvYmFsIGNvbnNvbGUgKi9cblxudmFyIEJhc2U2NCA9IHtcbiAgICAvKiBDb252ZXJ0IGRhdGEgKGFuIGFycmF5IG9mIGludGVnZXJzKSB0byBhIEJhc2U2NCBzdHJpbmcuICovXG4gICAgdG9CYXNlNjRUYWJsZSA6ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPScuc3BsaXQoJycpLFxuICAgIGJhc2U2NFBhZCAgICAgOiAnPScsXG5cbiAgICBlbmNvZGU6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgICAgIHZhciB0b0Jhc2U2NFRhYmxlID0gQmFzZTY0LnRvQmFzZTY0VGFibGU7XG4gICAgICAgIHZhciBsZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgdmFyIGxlbmd0aHBhZCA9IChsZW5ndGggJSAzKTtcbiAgICAgICAgLy8gQ29udmVydCBldmVyeSB0aHJlZSBieXRlcyB0byA0IGFzY2lpIGNoYXJhY3RlcnMuXG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAobGVuZ3RoIC0gMik7IGkgKz0gMykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IHRvQmFzZTY0VGFibGVbZGF0YVtpXSA+PiAyXTtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0b0Jhc2U2NFRhYmxlWygoZGF0YVtpXSAmIDB4MDMpIDw8IDQpICsgKGRhdGFbaSArIDFdID4+IDQpXTtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0b0Jhc2U2NFRhYmxlWygoZGF0YVtpICsgMV0gJiAweDBmKSA8PCAyKSArIChkYXRhW2kgKyAyXSA+PiA2KV07XG4gICAgICAgICAgICByZXN1bHQgKz0gdG9CYXNlNjRUYWJsZVtkYXRhW2kgKyAyXSAmIDB4M2ZdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udmVydCB0aGUgcmVtYWluaW5nIDEgb3IgMiBieXRlcywgcGFkIG91dCB0byA0IGNoYXJhY3RlcnMuXG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgaWYgKGxlbmd0aHBhZCA9PT0gMikge1xuICAgICAgICAgICAgaiA9IGxlbmd0aCAtIGxlbmd0aHBhZDtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0b0Jhc2U2NFRhYmxlW2RhdGFbal0gPj4gMl07XG4gICAgICAgICAgICByZXN1bHQgKz0gdG9CYXNlNjRUYWJsZVsoKGRhdGFbal0gJiAweDAzKSA8PCA0KSArIChkYXRhW2ogKyAxXSA+PiA0KV07XG4gICAgICAgICAgICByZXN1bHQgKz0gdG9CYXNlNjRUYWJsZVsoZGF0YVtqICsgMV0gJiAweDBmKSA8PCAyXTtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0b0Jhc2U2NFRhYmxlWzY0XTtcbiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGhwYWQgPT09IDEpIHtcbiAgICAgICAgICAgIGogPSBsZW5ndGggLSBsZW5ndGhwYWQ7XG4gICAgICAgICAgICByZXN1bHQgKz0gdG9CYXNlNjRUYWJsZVtkYXRhW2pdID4+IDJdO1xuICAgICAgICAgICAgcmVzdWx0ICs9IHRvQmFzZTY0VGFibGVbKGRhdGFbal0gJiAweDAzKSA8PCA0XTtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0b0Jhc2U2NFRhYmxlWzY0XTtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0b0Jhc2U2NFRhYmxlWzY0XTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qIENvbnZlcnQgQmFzZTY0IGRhdGEgdG8gYSBzdHJpbmcgKi9cbiAgICAvKiBqc2hpbnQgLVcwMTMgKi9cbiAgICB0b0JpbmFyeVRhYmxlIDogW1xuICAgICAgICAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSxcbiAgICAgICAgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsXG4gICAgICAgIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsNjIsIC0xLC0xLC0xLDYzLFxuICAgICAgICA1Miw1Myw1NCw1NSwgNTYsNTcsNTgsNTksIDYwLDYxLC0xLC0xLCAtMSwgMCwtMSwtMSxcbiAgICAgICAgLTEsIDAsIDEsIDIsICAzLCA0LCA1LCA2LCAgNywgOCwgOSwxMCwgMTEsMTIsMTMsMTQsXG4gICAgICAgIDE1LDE2LDE3LDE4LCAxOSwyMCwyMSwyMiwgMjMsMjQsMjUsLTEsIC0xLC0xLC0xLC0xLFxuICAgICAgICAtMSwyNiwyNywyOCwgMjksMzAsMzEsMzIsIDMzLDM0LDM1LDM2LCAzNywzOCwzOSw0MCxcbiAgICAgICAgNDEsNDIsNDMsNDQsIDQ1LDQ2LDQ3LDQ4LCA0OSw1MCw1MSwtMSwgLTEsLTEsLTEsLTFcbiAgICBdLFxuICAgIC8qIGpzaGludCArVzAxMyAqL1xuXG4gICAgZGVjb2RlOiBmdW5jdGlvbiAoZGF0YSwgb2Zmc2V0KSB7XG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgICBvZmZzZXQgPSB0eXBlb2Yob2Zmc2V0KSAhPT0gJ3VuZGVmaW5lZCcgPyBvZmZzZXQgOiAwO1xuICAgICAgICB2YXIgdG9CaW5hcnlUYWJsZSA9IEJhc2U2NC50b0JpbmFyeVRhYmxlO1xuICAgICAgICB2YXIgYmFzZTY0UGFkID0gQmFzZTY0LmJhc2U2NFBhZDtcbiAgICAgICAgdmFyIHJlc3VsdCwgcmVzdWx0X2xlbmd0aDtcbiAgICAgICAgdmFyIGxlZnRiaXRzID0gMDsgLy8gbnVtYmVyIG9mIGJpdHMgZGVjb2RlZCwgYnV0IHlldCB0byBiZSBhcHBlbmRlZFxuICAgICAgICB2YXIgbGVmdGRhdGEgPSAwOyAvLyBiaXRzIGRlY29kZWQsIGJ1dCB5ZXQgdG8gYmUgYXBwZW5kZWRcbiAgICAgICAgdmFyIGRhdGFfbGVuZ3RoID0gZGF0YS5pbmRleE9mKCc9JykgLSBvZmZzZXQ7XG5cbiAgICAgICAgaWYgKGRhdGFfbGVuZ3RoIDwgMCkgeyBkYXRhX2xlbmd0aCA9IGRhdGEubGVuZ3RoIC0gb2Zmc2V0OyB9XG5cbiAgICAgICAgLyogRXZlcnkgZm91ciBjaGFyYWN0ZXJzIGlzIDMgcmVzdWx0aW5nIG51bWJlcnMgKi9cbiAgICAgICAgcmVzdWx0X2xlbmd0aCA9IChkYXRhX2xlbmd0aCA+PiAyKSAqIDMgKyBNYXRoLmZsb29yKChkYXRhX2xlbmd0aCAlIDQpIC8gMS41KTtcbiAgICAgICAgcmVzdWx0ID0gbmV3IEFycmF5KHJlc3VsdF9sZW5ndGgpO1xuXG4gICAgICAgIC8vIENvbnZlcnQgb25lIGJ5IG9uZS5cbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMCwgaSA9IG9mZnNldDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjID0gdG9CaW5hcnlUYWJsZVtkYXRhLmNoYXJDb2RlQXQoaSkgJiAweDdmXTtcbiAgICAgICAgICAgIHZhciBwYWRkaW5nID0gKGRhdGEuY2hhckF0KGkpID09PSBiYXNlNjRQYWQpO1xuICAgICAgICAgICAgLy8gU2tpcCBpbGxlZ2FsIGNoYXJhY3RlcnMgYW5kIHdoaXRlc3BhY2VcbiAgICAgICAgICAgIGlmIChjID09PSAtMSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbGxlZ2FsIGNoYXJhY3RlciBjb2RlIFwiICsgZGF0YS5jaGFyQ29kZUF0KGkpICsgXCIgYXQgcG9zaXRpb24gXCIgKyBpKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ29sbGVjdCBkYXRhIGludG8gbGVmdGRhdGEsIHVwZGF0ZSBiaXRjb3VudFxuICAgICAgICAgICAgbGVmdGRhdGEgPSAobGVmdGRhdGEgPDwgNikgfCBjO1xuICAgICAgICAgICAgbGVmdGJpdHMgKz0gNjtcblxuICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSA4IG9yIG1vcmUgYml0cywgYXBwZW5kIDggYml0cyB0byB0aGUgcmVzdWx0XG4gICAgICAgICAgICBpZiAobGVmdGJpdHMgPj0gOCkge1xuICAgICAgICAgICAgICAgIGxlZnRiaXRzIC09IDg7XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIGlmIG5vdCBwYWRkaW5nLlxuICAgICAgICAgICAgICAgIGlmICghcGFkZGluZykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbaWR4KytdID0gKGxlZnRkYXRhID4+IGxlZnRiaXRzKSAmIDB4ZmY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxlZnRkYXRhICY9ICgxIDw8IGxlZnRiaXRzKSAtIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgYW55IGJpdHMgbGVmdCwgdGhlIGJhc2U2NCBzdHJpbmcgd2FzIGNvcnJ1cHRlZFxuICAgICAgICBpZiAobGVmdGJpdHMpIHtcbiAgICAgICAgICAgIGVyciA9IG5ldyBFcnJvcignQ29ycnVwdGVkIGJhc2U2NCBzdHJpbmcnKTtcbiAgICAgICAgICAgIGVyci5uYW1lID0gJ0Jhc2U2NC1FcnJvcic7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn07IC8qIEVuZCBvZiBCYXNlNjQgbmFtZXNwYWNlICovXG5cbmV4cG9ydCBkZWZhdWx0IEJhc2U2NDtcbiJdfQ==